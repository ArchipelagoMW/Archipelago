.gba

.autoregion
.align 2
PassagePaletteTable:
    .halfword 0x7B3E, 0x723C, 0x6576, 0x58B0, 0x4C07  ; Entry passage
    .halfword 0x5793, 0x578D, 0x4B20, 0x2E40, 0x1160  ; Emerald passage
    .halfword 0x6B5F, 0x529F, 0x253F, 0x14B4, 0x14AE  ; Ruby passage
    .halfword 0x6BDF, 0x23DF, 0x139B, 0x1274, 0x0DAE  ; Topaz passage
    .halfword 0x7F5A, 0x7E94, 0x7D29, 0x50A5, 0x38A5  ; Sapphire passage
    .halfword 0x579F, 0x3B1F, 0x1A7F, 0x05DE, 0x00FB  ; Golden pyramid
    .halfword 0x3D9C, 0x327D, 0x2B28, 0x6A3B, 0x6DED  ; Archipelago item

.definelabel @ObjectPalette4, 0x5000280

; Set the end of object palette 4 to the colors matching the passage in r0
SetTreasurePalette:
    ldr r1, =PassagePaletteTable
    lsl r2, r0, #2
    add r0, r2, r0
    lsl r0, r0, #1
    add r0, r1, r0

; DMA transfer - 5 halfwords from palette table entry
    ldr r1, =REG_DMA3SAD
    str r0, [r1]
    ldr r0, =@ObjectPalette4 + 0x296 - 0x280
    str r0, [r1, #4]
    ldr r0, =0x80000005
    str r0, [r1, #8]
    ldr r0, [r1, #8]

    mov pc, lr
.pool

.endautoregion

; Archipelago logo in 4bpp uncompressed
; Place this in some unused space in the tile data near the jewels and such
.org 0x84020A8
APLogoTile1:
    .byte 0x00, 0x00, 0x00, 0x50
    .byte 0x00, 0x00, 0x00, 0xB5
    .byte 0x00, 0x50, 0x55, 0xBB
    .byte 0x00, 0x85, 0x88, 0xB5
    .byte 0x50, 0x88, 0x88, 0x58
    .byte 0x50, 0x88, 0x88, 0x58
    .byte 0x50, 0x58, 0x55, 0x55
    .byte 0x00, 0xF5, 0xFF, 0x05

APLogoTile2:
    .byte 0x55, 0x00, 0x00, 0x00
    .byte 0xBB, 0x05, 0x00, 0x00
    .byte 0xBB, 0x5B, 0x55, 0x00
    .byte 0xBB, 0xD5, 0xDD, 0x05
    .byte 0x5B, 0xDD, 0xDD, 0x5D
    .byte 0x5B, 0xDD, 0xDD, 0x5D
    .byte 0x55, 0x5D, 0x55, 0x5D
    .byte 0x00, 0xE5, 0xEE, 0x05

.org 0x84024A8
APLogoTile3:
    .byte 0x50, 0xFF, 0xFF, 0x5F
    .byte 0x50, 0xFF, 0xFF, 0x5F
    .byte 0x50, 0xFF, 0xFF, 0xC5
    .byte 0x00, 0xF5, 0x5F, 0xCC
    .byte 0x00, 0x50, 0x55, 0xCC
    .byte 0x00, 0x00, 0x50, 0xCC
    .byte 0x00, 0x00, 0x00, 0xC5
    .byte 0x00, 0x00, 0x00, 0x50

APLogoTile4:
    .byte 0x50, 0xEE, 0xEE, 0x5E
    .byte 0x55, 0xEE, 0xEE, 0x5E
    .byte 0xCC, 0xE5, 0xEE, 0x5E
    .byte 0xCC, 0x5C, 0xEE, 0x05
    .byte 0xCC, 0x5C, 0x55, 0x00
    .byte 0xCC, 0x5C, 0x00, 0x00
    .byte 0xCC, 0x05, 0x00, 0x00
    .byte 0x55, 0x00, 0x00, 0x00

.autoregion
.align 2
APLogoObj:
    .halfword 1, 0xF8, 0x41F8, 0x412E

.align 4
APLogoAnm:
    .word APLogoObj
    .byte 0xC8
    .fill 0, 3
    .word 0, 0
.endautoregion
